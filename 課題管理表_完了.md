# 課題管理表（完了済み）

このドキュメントには完了済みの課題のみを記録しています。

---

## 完了済み課題

### [高] 右クリックで編集メニュー（ギミックやスキルの追加、削除）を操作できるようにする
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - ギミック、バーストタイミング、フェーズ、スキルの右クリックから削除が可能に
  - フェーズの右クリックから「フェーズの区切りを追加」が可能に
  - 画面外に出ないよう位置を自動調整
- **関連ファイル**:
  - `src/components/ui/ContextMenu.vue` (新規作成)
  - `src/components/timeline/GimmickRow.vue`
  - `src/components/timeline/BurstHighlight.vue`
  - `src/components/timeline/PhaseRow.vue`
  - `src/components/timeline-items/SkillBar.vue`

### [高] ギミックがドラッグで移動できない
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - handleMouseDownにe.stopPropagation()を追加
  - ドラッグ処理の修正
- **関連ファイル**: `src/components/timeline/GimmickRow.vue:91-115`

### [高] バーストタイミングも移動や削除ができない
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - ドラッグ処理にe.stopPropagation()を追加
  - 右クリックメニューから削除可能に
- **関連ファイル**: `src/components/timeline/BurstHighlight.vue:61-85`

### [高] フェーズ名が編集できない
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - ダブルクリックによるインライン編集を実装
  - Enterキーまたはフォーカスアウトで確定
- **関連ファイル**: `src/components/timeline/PhaseRow.vue:49-64`

### [高] フェーズが削除できない
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - 右クリックメニューから削除可能（最低1つは必要なので条件付き無効化）
- **関連ファイル**: `src/components/timeline/PhaseRow.vue:82-112`

### [中] スキルやギミックなどドラッグ移動可能なオブジェクトは、その先頭が何分何秒に位置しているのかをドラッグ時に表示する
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - DragTimeIndicatorコンポーネントを新規作成
  - uiStoreにdraggingTime状態とsetDraggingTime()を追加
  - 「分:秒」形式でマウスカーソルの右上に追従表示
- **関連ファイル**:
  - `src/components/ui/DragTimeIndicator.vue` (新規作成)
  - `src/stores/uiStore.ts:28-29,127-135`
  - 各ドラッグ可能コンポーネント（GimmickRow, BurstHighlight, PhaseRow, SkillBar）

### [中] フェーズの区切りには垂直線を入れる
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - PhaseDividersコンポーネントを新規作成
  - フェーズの開始位置に灰色の垂直線を表示
- **関連ファイル**:
  - `src/components/timeline/PhaseDividers.vue` (新規作成)
  - `src/components/Timeline.vue`

### [中] フェーズの区切り追加は、フェーズのオブジェクトを右クリックした際に「フェーズの区切りを追加」から操作できるようにする
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - 右クリックメニューに「フェーズの区切りを追加」を実装
  - クリック位置を基準に分割処理を実行
- **関連ファイル**: `src/components/timeline/PhaseRow.vue:82-112`

### [中] ヘッダーの編集アイコンのうち、削除（ゴミ箱）は不要。右クリックから各オブジェクトが削除できるようにする
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - EditToolbarから削除ツールボタンを削除
  - 各オブジェクトの右クリックメニューから削除操作に統一
- **関連ファイル**: `src/components/header/EditToolbar.vue:7-10`

### [中] 各ジョブのタイムラインをマウスオーバーすると、バーストタイミングのハイライトが消えてしまう。常にハイライトは表示されるようにする
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - hover効果を`hover:bg-gray-800`から`hover:bg-gray-800/50`に変更
  - マウスオーバー時も背景が半透明になり、バーストハイライトが透けて見えるように
- **関連ファイル**: `src/components/timeline/MemberRow.vue:57`

### [低] 「保存」ボタンを「ダウンロード」ボタンにリネーム
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - 通常モード・編集モード両方の「保存」ボタンを「ダウンロード」に変更
- **関連ファイル**: `src/components/AppHeader.vue:43,71`

### [中] ギミックやスキルにメモを追加できるようにする
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - Gimmick, SkillPlacementの型にmemo?フィールドを追加
  - 右クリックメニューに「メモを編集」オプションを追加
  - メモ付きのオブジェクトには📝アイコンとリング表示
  - マウスオーバーでメモ内容をツールチップ表示
- **関連ファイル**:
  - `src/types/content.ts:30`
  - `src/types/party.ts:30`
  - `src/components/timeline/GimmickRow.vue`
  - `src/components/timeline-items/SkillBar.vue`

### [中] タイムライン上にメモを追加できるようにする（◆表示）
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - TimelineMemo型を新規定義
  - MemoMarkerRowコンポーネントを新規作成
  - ◆マーカーでメモ位置を表示、マウスオーバーで内容表示
  - 右クリックまたはメモ追加ツールでメモ追加可能
  - 編集モードでドラッグ移動可能
- **関連ファイル**:
  - `src/types/content.ts:40-44`
  - `src/stores/contentStore.ts:320-373`
  - `src/components/timeline/MemoMarkerRow.vue` (新規作成)
  - `src/components/timeline/TimelineHeader.vue`
  - `src/components/header/EditToolbar.vue`
  - `src/types/ui.ts:6`

### [高] フェーズは区切り位置（前フェーズの終端）だけを移動できるようにする
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - PhaseDividersコンポーネントを拡張してドラッグ可能に
  - 編集モード時にカーソルがew-resize（左右矢印）に変更
  - movePhaseDividerメソッドを追加（区切り位置のみ変更）
- **関連ファイル**:
  - `src/components/timeline/PhaseDividers.vue`
  - `src/stores/contentStore.ts:188-201`

### [高] ギミックの終端をドラッグして秒数調整できるようにする
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - GimmickRowにリサイズハンドルを追加
  - 終端ドラッグでcastDurationを調整
  - ドラッグ中は調整中の秒数を表示
- **関連ファイル**: `src/components/timeline/GimmickRow.vue:74-110,242-255`

### [高] パーティ選択時のチェック表示とコンテンツ連動
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - パーティ一覧でクリック選択、チェックマーク表示
  - 選択中のパーティはハイライト表示
  - モーダルを閉じたら選択パーティがコンテンツの対象パーティに
- **関連ファイル**: `src/components/modals/PartyManageModal.vue`

### [高] パーティ人数を2～8人で調整できるようにする
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - partyStoreにaddMember, removeMember, setMemberCountメソッドを追加
  - パーティ管理モーダルに人数調整UI（±ボタン、セレクト）を追加
  - デフォルト8人、最小2人、最大8人
- **関連ファイル**:
  - `src/stores/partyStore.ts:265-346`
  - `src/components/modals/PartyManageModal.vue:80-96,180-209`

### [高] スキルのドラッグ時に垂直線を追加
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - スキルドラッグ時に開始位置（黄色）と終了位置（青色）の垂直線を表示
  - uiStoreにdraggingSkillPositions状態とsetDraggingSkillPositionsメソッドを追加
  - SkillDragLinesコンポーネントを新規作成
- **関連ファイル**:
  - `src/stores/uiStore.ts:31-32,143-150,163,186`
  - `src/components/ui/SkillDragLines.vue` (新規作成)
  - `src/components/Timeline.vue:9,173`
  - `src/components/timeline-items/SkillBar.vue:126,132,135,142`

### [高] パーティスキルの効果表示
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - Skill型にphysicalMitigation、magicalMitigation、buffPowerを追加
  - スキルマスタJSONに各スキルの効果情報を設定
  - SkillBarでツールチップに効果情報を表示
- **関連ファイル**:
  - `src/types/skill.ts:17-19`
  - `public/data/skills/jobs.json` (全スキルに効果情報を追加)
  - `src/components/timeline-items/SkillBar.vue:48-62,171`

### [高] パーティスキルの効果集計
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - タイムライン上でパーティ全体の軽減スキル効果を集計
  - 物理軽減と魔法軽減をエリアグラフで可視化
  - useMitigationAggregation composableで1秒ごとの集計データを計算
  - MitigationGraphコンポーネントでSVGグラフを描画
  - MemberAreaの先頭に集計行を追加
- **関連ファイル**:
  - `src/composables/useMitigationAggregation.ts` (新規作成)
  - `src/components/timeline/MitigationGraph.vue` (新規作成)
  - `src/components/timeline/MemberArea.vue:3-5,12-17`
  - `src/components/Timeline.vue:117-121`

### [中] スキルのキャストタイム、リキャストタイムの追加
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-21
- **説明**:
  - Skill型にcastTimeプロパティを追加
  - キャストタイム: 黄色の縁、ピンク系の内部で表示
  - リキャストタイム: グレーの半透明で表示
  - 効果時間: 既存のカラフルなバーで表示
- **関連ファイル**:
  - `src/types/skill.ts:12`
  - `src/components/timeline-items/SkillBar.vue:29-59,207-218`
  - `public/data/skills/jobs.json` (castTime追加)

### [中] パーティメンバー間でのスキル干渉のアラート追加
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - ロールスキルが複数のメンバーで同時に使われている場合を検知
  - 干渉があるスキルには赤いリング（ring-2 ring-red-500）と警告アイコン（⚠️）を表示
  - ツールチップで干渉しているメンバー名を表示
  - useSkillInterference composableで干渉検知ロジックを実装
- **関連ファイル**:
  - `src/composables/useSkillInterference.ts` (新規作成)
  - `src/components/timeline-items/SkillBar.vue`

### [低] 軽減率のグラフの集計値表示
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - 軽減率グラフにマウスオーバーすると、その時刻の物理軽減率と魔法軽減率をツールチップで表示
  - 時刻も「分:秒」形式で表示
  - SVGにcursor-crosshairを追加して操作可能であることを示す
- **関連ファイル**:
  - `src/components/timeline/MitigationGraph.vue`

### [中] 不具合：同じスキルが干渉している時間帯に軽減率が加算されてしまっている
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - 同じスキルが複数メンバーで使われている場合、効果が重複カウントされないように修正
  - useMitigationAggregationで、skillIdごとにMapを使って重複を排除
  - 同じスキルIDが既に登録されている場合はスキップし、異なるスキルIDの軽減率のみ加算
- **関連ファイル**:
  - `src/composables/useMitigationAggregation.ts`

### [中] 軽減率の加算率は一目でどの程度の軽減率かわかるように
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - 物理と魔法で統一されたスケールを使用（両方の最大値を10の倍数に切り上げ）
  - 10%ごとに補助線（グリッドライン）を表示
  - 各補助線にパーセンテージのラベルを追加
  - 軽減率が一目でわかるように視覚的に改善
- **関連ファイル**:
  - `src/components/timeline/MitigationGraph.vue`

### [低] スキル名をスクロールに追従させる
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - 行頭部分にposition: sticky、left: 0、z-index: 10を追加
  - 横スクロール時にメンバー名が常に表示されるように固定
- **関連ファイル**:
  - `src/components/Timeline.vue`

### [中] スキル行の複数行化
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - 各メンバーに4つのレーン（行）を用意し、スキルを複数行に配置可能に
  - スキル追加・移動時に空いているレーンを自動選択
  - SkillPlacement型にlaneプロパティを追加（0〜3）
  - useSkillLane composableで重複チェックとレーン自動選択ロジックを実装
  - リキャストタイム中の別スキル使用時も干渉しないように配置
- **関連ファイル**:
  - `src/types/party.ts` - SkillPlacement型にlane追加
  - `src/composables/useSkillLane.ts` - レーン選択ロジック（新規作成）
  - `src/stores/partyStore.ts` - スキル追加・更新時の自動レーン選択
  - `src/components/timeline/MemberRow.vue` - 4レーン表示対応
  - `src/components/Timeline.vue` - メンバー名表示を4レーン対応

### [高] パーティリストのスクロール時の不具合
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - 行頭とメンバーエリアの縦スクロールを同期
  - スクロール無限ループ防止フラグを実装
  - MemberAreaコンポーネントにscrollイベントとrefを公開
  - Timeline.vueで両方のスクロールを相互同期
- **関連ファイル**:
  - `src/components/Timeline.vue` - スクロール同期ロジック追加
  - `src/components/timeline/MemberArea.vue` - scrollイベントとref公開

### [中] 軽減率の例外の追加
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - Skill型にinvincibleプロパティを追加
  - 無敵スキルがアクティブな時間帯はグラフに金色のハイライトを表示
  - ツールチップで「無敵」と表示
  - 無敵時は軽減率を100%に自動設定
- **関連ファイル**:
  - `src/types/skill.ts` - invincibleプロパティ追加
  - `src/composables/useMitigationAggregation.ts` - 無敵判定とisInvincible追加
  - `src/components/timeline/MitigationGraph.vue` - 無敵ハイライトとツールチップ表示

### [高] タイムラインスクロールの不具合修正
- **ステータス**: 完了
- **登録日**: 2026-01-21
- **完了日**: 2026-01-22
- **説明**:
  - MemberAreaコンポーネントのホイールイベントを親のTimeline.vueに委譲
  - 通常のホイールスクロールを横スクロールに変換
  - Shiftキー押下時はズーム機能（既存の動作を維持）
  - passive: falseオプションでpreventDefaultを有効化
- **関連ファイル**:
  - `src/components/timeline/MemberArea.vue` - wheelイベント委譲
  - `src/components/Timeline.vue` - MemberAreaからのwheelイベント受信
